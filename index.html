<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Hangman Drinks</title>
        <meta name="viewport" content="width=device-width, initial-scale=1 shrink-to-fit=no">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        <!-- Added CSS from Bootstrap -->
        <!-- <script src="assets/javascript/game.js"></script> -->
    </head>

    <body class="bg-white text-dark container">
            <nav>Optional</nav>
        
        <div class="jumbotron" >
                <h1 class="display-1 mt-5 text-light text-right">Hangman Game</h1>
                <p class="lead p-5 text-light text-right"><u> Press Any Key to Get Started</u></p>
        </div>

        <div class="row" id="1st-row"> 
                <div class="col md-6">
                    <p id="totalWins" >Wins: </p>
                    <p id="totalGuesses">Number of Guesses Remaining: </p>
                </div>    
                
                <div class="col md-6">
                    <h2 id="chosenWord">Word: MADONNA _ _ _ _ _ _ <h2>
                    <p id="guessedLetters">Letters Already Guessed: (L Z Y H).</p>
                    <p id="chancesLeft">Letters Already Guessed: (L Z Y H).</p>

                </div>
        
        </div>
        <script type="text/javascript">
            // Lists all possible values the CPU can choose from;
                const maxTries = 8; 
                var chancesLeft = 0; 
                //total number of tries based on a stick figure hangman
                var totalWins=0; 
                //Number of wins racked up
                var wordsArray=["beer","gin", "vodka", "whiskey", "wine"]; 
                //  Words Array   
                var guessedLetters=[]; //letters guessed
                var chosenWord = wordsArray[Math.floor(Math.random() * wordsArray.length)];
                // Select a random index from an array and stored it in the CPU Choice
                var guessingWord = [];
                var gameStarted = false;
                var gameFinished = false; 
                //Additional variables declared to reset the game
                
                // Reset our game-level variables
                function resetGame() {
                    chancesLeft = maxTries;
                    gameStarted = false;
                    // Randonly selects a word from our array
                    chosenWordIndex = Math.floor(Math.random() * (wordsArray.length));

                    // Clear out arrays
                    guessedLetters = [];
                    guessingWord = [];

                    // Build the guessing word and clear it out
                    for (var i = 0; i < guessingWord.length; i++) {
                     guessingWord[i] = "_";
                    }
                    var chancesLeft = guessingWord.length; 
                }
                resetGame();
                console.log(chancesLeft);                   

                    // Show display
                    updateDisplay();

                function updateDisplay() {

                    document.getElementById("totalWins").innerText = totalWins;
                    document.getElementById("chosenWord").innerText = "";
                    for (var i = 0; i < guessingWord.length; i++) {
                        document.getElementById("chosenWord").innerText += guessingWord[i];
                    }
                    document.getElementById("chancesLeft").innerText = chancesLeft;
                    document.getElementById("guessedLetters").innerText = guessedLetters;
                    if(chancesLeft <= 0) {
                        // document.getElementById("gameover-image").style.cssText = "display: block";
                        // document.getElementById("pressKeyTryAgain").style.cssText = "display:block";
                        hasFinished = true;
                    }
                };
                document.onkeydown = function(event) {
                    // If we finished a game, dump one keystroke and reset.
                    if(gameFinished) {
                        resetGame();
                        gameFinished = false;
                    } else {
                        // Check to make sure a-z was pressed.
                        if(event.keyCode >= 65 && event.keyCode <= 90) {
                            makeGuess(event.key.toLowerCase());
                        }
                    }
                }
// This function takes a letter and finds all instances of 
// appearance in the string and replaces them in the guess word.
// This function takes a letter and finds all instances of 
// appearance in the string and replaces them in the guess word.
            function makeGuess(letter) {
            console.log(chancesLeft)
                    if (guessedLetters.indexOf(letter) === -1) {
                        guessedLetters.push(letter);
                        evaluateGuess(letter);
                    }
            };
            function evaluateGuess(letter) {
                // Array to store positions of letters in string
                var positions = [];

    // Loop through word finding all instances of guessed letter, store the indicies in an array.
                for (var i = 0; i < wordsArray[currentWordIndex].length; i++) {
                    if(wordsArray[currentWordIndex][i] === letter) {
                        positions.push(i);
                    }
                }

                // if there are no indicies, remove a guess and update the hangman image
                if (positions.length <= 0) {
                    chancesLeft--;
                    console.log(chancesLeft)
                } else {
                    // Loop through all the indicies and replace the '_' with a letter.
                    for(var i = 0; i < positions.length; i++) {
                        guessingWord[positions[i]] = letter;
                    }
                }
            };
                function checkWin() {
                    if(guessingWord.indexOf("_") === -1) {
                        // document.getElementById("youwin-image").style.cssText = "display: block";
                        // document.getElementById("pressKeyTryAgain").style.cssText= "display: block";
                        totalWins++;
                        hasFinished = true;
                    }
};
        </script>
    </body>
</html>